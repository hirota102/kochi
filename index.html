<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>È´òÁü•„Ç´„Éï„ÇßÂàá„ÇäÊõø„ÅàMAP</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        :root {
            --work-color: #2c3e50;
            --chat-color: #e67e22;
            --bg-light: #fdfcfb;
            --insta-color: #e1306c;
        }

        body {
            margin: 0;
            font-family: 'Hiragino Kaku Gothic ProN', sans-serif;
            background: var(--bg-light);
            overflow: hidden;
        }

        /* „É¢„Éº„ÉâÂàáÊõø */
        .mode-selector {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1001;
            display: flex;
            background: white;
            padding: 5px;
            border-radius: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 400px;
        }

        .mode-btn {
            flex: 1;
            border: none;
            padding: 12px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            font-size: 0.9rem;
        }

        .mode-btn.work.active { background: var(--work-color); color: white; }
        .mode-btn.chat.active { background: var(--chat-color); color: white; }
        .mode-btn:not(.active) { background: transparent; color: #999; }

        #map { height: 55vh; }

        /* „É™„Çπ„Éà */
        .list-container {
            height: 45vh;
            overflow-y: auto;
            background: white;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            padding: 15px;
        }

        .cafe-card {
            display: flex;
            gap: 18px;
            padding: 18px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        .cafe-img-wrap {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .cafe-img {
            width: 110px;
            height: 110px;
            border-radius: 16px;
            object-fit: cover;
            background: #eee;
        }

        .cafe-img.sweet {
            height: 70px;
        }

        .cafe-name {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .cafe-addr {
            font-size: 0.75rem;
            color: #777;
            margin: 4px 0;
        }

        .tag-row {
            margin-bottom: 8px;
        }

        .tag {
            display: inline-block;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 4px;
            margin-right: 4px;
            margin-bottom: 4px;
            border: 1px solid;
        }

        .work-tag { color: var(--work-color); border-color: var(--work-color); }
        .chat-tag { color: var(--chat-color); border-color: var(--chat-color); }

        .insta-btn {
            display: inline-block;
            font-size: 0.7rem;
            color: var(--insta-color);
            border: 1px solid var(--insta-color);
            padding: 2px 8px;
            border-radius: 4px;
            text-decoration: none;
            transition: 0.2s;
            font-weight: bold;
        }

        .insta-btn:active {
            background: var(--insta-color);
            color: white;
        }

        /* ÂÜôÁúü„Éî„É≥ */
        .photo-marker {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid white;
            background-size: cover;
            background-position: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.35);
        }

        .leaflet-popup-content-wrapper {
            border-radius: 12px;
        }
    </style>
</head>

<body>

<div class="mode-selector">
    <button class="mode-btn work active" onclick="switchMode('work')">üíª ÈõÜ‰∏≠‰ΩúÊ•≠</button>
    <button class="mode-btn chat" onclick="switchMode('chat')">‚òïÔ∏è „ÅäÂñã„Çä</button>
</div>

<div id="map"></div>
<div class="list-container" id="list-container"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const cafes = [
    // --- WORK MODE ---
    {
        id: 1,
        mode: 'work',
        name: "SPOON",
        addr: "È´òÁü•Â∏ÇÊú¨Áî∫3-2-45",
        lat: 33.5593,
        lng: 133.5369,
        img: "https://pilgrim-shikoku.net/cms/wp-content/uploads/2023/09/%E5%96%AB%E8%8C%B6SPOON_%E5%86%85%E8%A6%B3.jpg",
        sweetImg: "https://represent-kochi.com/wp-content/uploads/2022/09/s-DSC_4633-2-1024x683.jpg",
        tags: ["Wi-Fi", "ËêΩ„Å°ÁùÄ„Åè", "ÈßÖËøë"],
        inst: "https://www.instagram.com/spoon.1971/?hl=ja"
    },
    {
        id: 2,
        mode: 'work',
        name: "„Éú„Çø„Éã„Ç´„É´„Ç´„Éï„Çß konoha",
        addr: "È´òÁü•Â∏ÇÊú¨Áî∫4-1-24 ÈõªÊ∞ó„Éì„É´Êñ∞È§®1F",
        lat: 33.5589,
        lng: 133.5348,
        img: "https://newsatcl-pctr.c.yimg.jp/dk/expert-image/yuzuyu/article/02062371/image-1736827262973.jpeg?fill=1&fc=fff&exp=10800",
        sweetImg: "https://img.retsta.jp/rkc/media/guruguru/article/gourmet/gourmet_1702626624317/IMG_1066.jpg",
        tags: ["Ê§çÁâ©", "Èùô„Åã", "Áôí„ÇÑ„Åó"],
        inst: "https://www.instagram.com/botanicalcafekonoha/"
    },
    {
        id: 3,
        mode: 'work',
        name: "COCHI COCOCHI „Ç≥„Éº„Éí„Éº",
        addr: "È´òÁü•Â∏ÇÊ†ÑÁî∞Áî∫2-1-10 (È´òÁü•ÈßÖ1F)",
        lat: 33.5670,
        lng: 133.5435,
        img: "https://ximg.retty.me/crop/s400x400/q80/das/-/retty/img_repo/2l/01/16381169.jpg",
        sweetImg: "https://ximg.retty.me/crop/s400x400/q80/das/-/retty/img_repo/2l/01/36980472.jpg",
        tags: ["ÈßÖ„Éä„Ç´", "ÈõªÊ∫ê„ÅÇ„Çä", "Êó©ÊúùOK"],
        inst: "https://www.instagram.com/cocochi_coffee/"
    },
    {
        id: 4,
        mode: 'work',
        name: "GRAYGE COFFEE ROASTER",
        addr: "È´òÁü•Â∏ÇÂ∞èÊ¥•Áî∫3-2",
        lat: 33.5638,
        lng: 133.5285,
        img: "https://kochikaigi-yeg.jp/wp-content/uploads/2023/11/GRAYGE-COFFEE-ROASTER.jpg",
        sweetImg: "https://og-image.retty.me/restaurant/100001676662/",
        tags: ["Ëá™ÂÆ∂ÁÑôÁÖé", "„É¢„ÉÄ„É≥", "ÈõÜ‰∏≠"],
        inst: "https://www.instagram.com/grayge_coffee/"
    },
    {
        id: 5,
        mode: 'work',
        name: "„Ç´„ÉØ„ÇØ„Éú„Ç≥„Éº„Éí„Éº",
        addr: "È´òÁü•Â∏ÇÂ§ßÂ∑ùÁ≠ã1-7-31",
        lat: 33.5656,
        lng: 133.5402,
        img: "https://bu-sanblog.website/wp-content/uploads/2024/01/IMG_5177-768x1024.jpg",
        sweetImg: "https://ximg.retty.me/crop/s400x400/q80/das/-/retty/img_repo/2l/01/29364118.jpg",
        tags: ["Ëá™ÂÆ∂ÁÑôÁÖé", "Èùô„Åã", "ÈßÖËøë"],
        inst: "https://www.instagram.com/kawakubocoffee/"
    },

    // --- CHAT MODE ---
    {
        id: 6,
        mode: 'chat',
        name: "terzo tempo",
        addr: "È´òÁü•Â∏ÇÊ°ú‰∫ïÁî∫2-5-30",
        lat: 33.5589,
        lng: 133.5505,
        img: "https://kurashi-to-oshare.jp/wntrlp/wp-content/uploads/s-terzo1.jpg",
        sweetImg: "https://tblg.k-img.com/restaurant/images/Rvw/82420/640x640_rect_82420155.jpg",
        tags: ["„Ç™„Ç∑„É£„É¨", "„Çπ„Ç§„Éº„ÉÑ"],
        inst: "https://www.instagram.com/terzo_tempo/?hl=ja"
    },
    {
        id: 7,
        mode: 'chat',
        name: "5019 PREMIUM FACTORY",
        addr: "È´òÁü•Â∏ÇÂ∏ØÂ±ãÁî∫1-10-21",
        lat: 33.5595,
        lng: 133.5395,
        img: "https://images.unsplash.com/photo-1514933651103-005eec06c04b?w=400",
        sweetImg: "https://images.unsplash.com/photo-1550317138-10000687a72b?w=400",
        tags: ["„Éê„Éº„Ç¨„Éº", "Ë≥ë„ÇÑ„Åã"],
        inst: "https://www.instagram.com/5019premiumfactory/"
    },
    {
        id: 8,
        mode: 'chat',
        name: "„Ç´„Éï„Çß„Éª„Éâ„ÉªÊ¢µ",
        addr: "È´òÁü•Â∏ÇÂ∏ØÂ±ãÁî∫1-14-33-1F",
        lat: 33.5598,
        lng: 133.5385,
        img: "https://images.unsplash.com/photo-1521017432531-fbd92d768814?w=400",
        sweetImg: "https://tblg.k-img.com/restaurant/images/Rvw/289342/640x640_rect_d420b9c6e7294965bdb6b9f521a5cced.jpg",
        tags: ["„É¢„Éº„Éã„É≥„Ç∞", "‰ºöË©±"],
        inst: "https://www.instagram.com/explore/locations/4394600/kafe-do-fan/"
    },
    {
        id: 9,
        mode: 'chat',
        name: "„Éû„É≥„Ç∏„Çß„Éª„Çµ„Çµ",
        addr: "È´òÁü•Â∏ÇÈ´ò„Åù„Å≠20-5",
        lat: 33.5705,
        lng: 133.5585,
        img: "https://hotkochi.co.jp/files/post/57141/0311e489222bae100efd54c938b3d0ac-600x400.jpg",
        sweetImg: "https://www.kochidon.net/images/A00000536page00000225.jpg",
        tags: ["„Éë„ÉÜ„Ç£„Çπ„É™„Éº", "Â∫É„ÅÑÈßêËªäÂ†¥"],
        inst: "https://www.instagram.com/mangersasa/?hl=ja"
    },
    {
        id: 10,
        mode: 'chat',
        name: "uffington parfait",
        addr: "È´òÁü•Â∏ÇÊñ∞Êú¨Áî∫2-4-3 bliss„Éì„É´2F",
        lat: 33.5684,
        lng: 133.5412,
        img: "https://ximg.retty.me/crop/s400x400/q80/das/-/retty/img_repo/2l/01/34569186.jpg",
        sweetImg: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSybPnzdEpa8Fi9JxgEEX6G2DQ-dAZnXtoQqA&s",
        tags: ["Â§ú„Éë„Éï„Çß", "ÈßÖÂåóÂè£", "Èö†„ÇåÂÆ∂"],
        inst: "https://www.instagram.com/uffington_parfait/"
    }
];

let currentMode = 'work';
const map = L.map('map', { zoomControl:false }).setView([33.5630, 133.5410], 15);
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

let markers = [];

function updateView() {
    markers.forEach(m => map.removeLayer(m));
    markers = [];
    const list = document.getElementById('list-container');
    list.innerHTML = '';

    cafes.filter(c => c.mode === currentMode).forEach(cafe => {

        const marker = L.marker([cafe.lat, cafe.lng], {
            icon: L.divIcon({
                className: '',
                html: `<div class="photo-marker" style="background-image:url('${cafe.img}')"></div>`,
                iconSize: [60,60],
                iconAnchor: [30,60],
                popupAnchor: [0,-60]
            })
        }).addTo(map);

        marker.bindPopup(`
            <div style="width:200px">
                <img src="${cafe.img}" style="width:100%;border-radius:10px;margin-bottom:6px">
                <b>${cafe.name}</b><br>
                <small>${cafe.addr}</small><br>
                ${cafe.inst ? `<a href="${cafe.inst}" target="_blank" class="insta-btn" style="margin-top:8px;">üì∑ Instagram</a>` : ''}
            </div>
        `);

        markers.push(marker);

        const card = document.createElement('div');
        card.className = 'cafe-card';
        card.innerHTML = `
            <div class="cafe-img-wrap">
                <img src="${cafe.img}" class="cafe-img">
                ${cafe.sweetImg ? `<img src="${cafe.sweetImg}" class="cafe-img sweet">` : ''}
            </div>
            <div style="flex:1">
                <div class="cafe-name">${cafe.name}</div>
                <div class="cafe-addr">${cafe.addr}</div>
                <div class="tag-row">
                    ${cafe.tags.map(t => `<span class="tag ${currentMode}-tag">${t}</span>`).join('')}
                </div>
                ${cafe.inst ? `
                    <a href="${cafe.inst}" target="_blank" class="insta-btn" onclick="event.stopPropagation();">
                        üì∑ Instagram
                    </a>` : ''}
            </div>
        `;

        card.onclick = () => {
            map.flyTo([cafe.lat, cafe.lng], 17);
            marker.openPopup();
        };

        list.appendChild(card);
    });
}

function switchMode(mode) {
    currentMode = mode;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.mode-btn.' + mode).classList.add('active');
    updateView();
}

updateView();
</script>
</body>
</html>
